.TH AM "8" "September 2019" "ibnbd 0.1.0" "System Administration Utilities"
.SH NAME
ibnbd - Configuration tool for IBNBD driver and IBTRS library.
.SH SYNOPSIS
ibnbd {list|show|map|resize|unmap|remap|disconnect|reconnect|addpath|delpath|help} [ARGUMENTS]
.SH DESCRIPTION
Usage: ibnbd {list|show|map|resize|unmap|remap|disconnect|reconnect|addpath|delpath|help} [ARGUMENTS]

IBNBD command line utility.

Subcommands:
     list                List block device or transport related information
     show                Show information about a device, a session or a path
     map                 Map a device from a given server
     resize              Resize a mapped device
     unmap               Unmap an imported device
     remap               Remap a device or all devices on a session
     disconnect          Disconnect a path or a session
     reconnect           Reconnect a path or a session
     addpath             Add a path to an existing session
     delpath             Delete a path
     help                Display help

Options:
    verbose         Verbose output
    help            Display help and exit
.SH SUBCOMMANDS
.B list

Usage: ibnbd list [OPTIONS]

List block device or transport related information: devices, sessions, paths, etc.

Options:
    {mode}          Information to print: devices|sessions|paths.
                    Default: devices.
    {fields}        Comma separated list of fields to be printed. The list can be
                    prefixed with '+' or '-' to add or remove fields from the
                    default selection.

                    Device Fields
                    Field           Header         Description
                    sessname        Session        Name of the IBTRS session of the device
                    mapping_path    Mapping Path   Mapping name of the remote device
                    devname         Device         Device name under /dev/. I.e. ibnbd0
                    devpath         Device path    Device path under /dev/. I.e. /dev/ibnbd0
                    state           State          State of the IBNBD device. (client only)
                    access_mode     Access Mode    RW mode of the device: ro, rw or migration
                    io_mode         IO mode        IO submission mode of the target device: file/block
                    rx_sect         RX             Amount of data read from the device
                    tx_sect         TX             Amount of data written to the device
                    direction       Direction      Direction of data transfer: imported or exported

                    Default client: sessname,mapping_path,devname,state,access_mode,io_mode
                    Default server: sessname,mapping_path,devname,access_mode,io_mode

                    Session Fields
                    Field           Header         Description
                    sessname        Session name   Name of the session
                    path_cnt        Path cnt       Number of paths
                    act_path_cnt    Act path cnt   Number of active paths
                    state           State          State of the session.
                    path_uu         PS             Up (U) or down (_) state of every path
                    mp              MP Policy      Multipath policy
                    mp_short        MP             Multipath policy (short)
                    rx_bytes        RX             Bytes received
                    tx_bytes        TX             Bytes send
                    inflights       Inflights      Inflights
                    reconnects      Reconnects     Reconnects
                    side            Direction      Direction of the session: incoming or outgoing

                    Default client: sessname,state,path_uu,mp_short,tx_bytes,rx_bytes,inflights,reconnects
                    Default server: sessname,path_cnt,tx_bytes,rx_bytes,inflights

                    Path Fields
                    Field           Header         Description
                    sessname        Sessname       Name of the session.
                    pathname        Path name      Path name
                    src_addr        Client Addr    Client address of the path
                    dst_addr        Server Addr    Server address of the path
                    hca_name        HCA            HCA name
                    hca_port        Port           HCA port
                    state           State          Name of the path
                    rx_bytes        RX             Bytes received
                    tx_bytes        TX             Bytes send
                    inflights       Inflights      Inflights
                    reconnects      Reconnects     Reconnects
                    direction       Direction      Direction of the path: incoming or outgoing

                    Default client: sessname,hca_name,hca_port,dst_addr,state,tx_bytes,rx_bytes,inflights,reconnects
                    Default server: sessname,hca_name,hca_port,src_addr,tx_bytes,rx_bytes,inflights


                    Provide 'all' to print all available fields
    {format}        Output format: csv|json|xml
    {unit}          Units to use for size (in binary): B|K|M|G|T|P|E
    notree          Don't display paths for each sessions
    noheaders       Don't print headers
    nototals        Don't print totals
    help            Display help and exit


.B show

Usage: ibnbd show <name> [path] [OPTIONS]

Show information about an ibnbd block- or transport- item: device, session or path.

Arguments:
    <name>          Name of a local or a remote block device, session name, path name or remote hostname.
                    I.e. ibnbd0, /dev/ibnbd0, d12aef94-4110-4321-9373-3be8494a557b, ps401a-1@st401b-2, st401b-2, <ip1>@<ip2>, etc.
                    In order to display path information, path name or identifier
                    has to be provided, i.e. st401b-2:1.

Options:
    {fields}        Comma separated list of fields to be printed. The list can be
                    prefixed with '+' or '-' to add or remove fields from the
                    default selection.

                    Device Fields
                    Field           Header         Description
                    sessname        Session        Name of the IBTRS session of the device
                    mapping_path    Mapping Path   Mapping name of the remote device
                    devname         Device         Device name under /dev/. I.e. ibnbd0
                    devpath         Device path    Device path under /dev/. I.e. /dev/ibnbd0
                    state           State          State of the IBNBD device. (client only)
                    access_mode     Access Mode    RW mode of the device: ro, rw or migration
                    io_mode         IO mode        IO submission mode of the target device: file/block
                    rx_sect         RX             Amount of data read from the device
                    tx_sect         TX             Amount of data written to the device
                    direction       Direction      Direction of data transfer: imported or exported

                    Default client: sessname,mapping_path,devname,state,access_mode,io_mode
                    Default server: sessname,mapping_path,devname,access_mode,io_mode

                    Sessions Fields
                    Field           Header         Description
                    sessname        Session name   Name of the session
                    path_cnt        Path cnt       Number of paths
                    act_path_cnt    Act path cnt   Number of active paths
                    state           State          State of the session.
                    path_uu         PS             Up (U) or down (_) state of every path
                    mp              MP Policy      Multipath policy
                    mp_short        MP             Multipath policy (short)
                    rx_bytes        RX             Bytes received
                    tx_bytes        TX             Bytes send
                    inflights       Inflights      Inflights
                    reconnects      Reconnects     Reconnects
                    side            Direction      Direction of the session: incoming or outgoing

                    Default client: sessname,state,path_uu,mp_short,tx_bytes,rx_bytes,inflights,reconnects
                    Default server: sessname,path_cnt,tx_bytes,rx_bytes,inflights

                    Paths Fields
                    Field           Header         Description
                    sessname        Sessname       Name of the session.
                    pathname        Path name      Path name
                    src_addr        Client Addr    Client address of the path
                    dst_addr        Server Addr    Server address of the path
                    hca_name        HCA            HCA name
                    hca_port        Port           HCA port
                    state           State          Name of the path
                    rx_bytes        RX             Bytes received
                    tx_bytes        TX             Bytes send
                    inflights       Inflights      Inflights
                    reconnects      Reconnects     Reconnects
                    direction       Direction      Direction of the path: incoming or outgoing

                    Default client: sessname,hca_name,hca_port,dst_addr,state,tx_bytes,rx_bytes,inflights,reconnects
                    Default server: sessname,hca_name,hca_port,src_addr,tx_bytes,rx_bytes,inflights


                    Provide 'all' to print all available fields
    {format}        Output format: csv|json|xml
    {unit}          Units to use for size (in binary): B|K|M|G|T|P|E
    {mode}          Information to print: device|session|path. Default: device.
    help            Display help and exit


.B map

Usage: ibnbd map <path> from <server> [OPTIONS]

Map a device from a given server

Arguments:
    <device>        Path to the device to be mapped on server side
    from <server>   Address, hostname or session name of the server

Options:
    <path>          Path(s) to establish: [src_addr@]dst_addr
                    Address is [ip:]<ipv4>, [ip:]<ipv6> or gid:<gid>
    {io_mode}       IO Mode to use on server side: fileio|blockio. Default: blockio
    {rw}            Access permission on server side: ro|rw|migration. Default: rw
    verbose         Verbose output
    help            Display help and exit


.B resize

Usage: ibnbd resize <device name or path or mapping path> [OPTIONS]

Change size of a mapped device

Arguments:
    <device>        Name of the device to be unmapped
    <size>          New size of the device in bytes

Options:
    verbose         Verbose output
    help            Display help and exit


.B unmap

Usage: ibnbd unmap <device name or path or mapping path> [OPTIONS]

Umap a given imported device

Arguments:
    <device>        Name of the device to be unmapped

Options:
    force           Force operation
    verbose         Verbose output
    help            Display help and exit


.B remap

Usage: ibnbd remap <devname|sessname> [OPTIONS]

Unmap and map again an imported device or do this for all devices of a given session

Arguments:
    <identifier>    Identifier of a device to be remapped. Or identifier of a session to remap all devices on.

Options:
    force           Force operation
    verbose         Verbose output
    help            Display help and exit


.B disconnect

Usage: ibnbd disconnect <path or session> [OPTIONS]

Disconnect a path or all paths on a given session

Arguments:
    <identifier>    Name or identifier of a session or of a path:
                    [sessname], [pathname], [sessname:port], etc.

Options:
    verbose         Verbose output
    help            Display help and exit


.B reconnect

Usage: ibnbd reconnect <path or session> [OPTIONS]

Disconnect and connect again a path or a whole session

Arguments:
    <identifier>    Name or identifier of a session or of a path:
                    [sessname], [pathname], [sessname:port], etc.

Options:
    verbose         Verbose output
    help            Display help and exit


.B addpath

Usage: ibnbd addpath <session> <path> [OPTIONS]

Add a new path to an existing session

Arguments:
    <session>       Name of the session to add the new path to
    <path>          Path to be added: [src_addr,]dst_addr
                    Address is of the form ip:<ipv4>, ip:<ipv6> or gid:<gid>

Options:
    verbose         Verbose output
    help            Display help and exit


.B delpath

Usage: ibnbd delpath <path> [OPTIONS]

Delete a given path from the corresponding session

Arguments:
    <path>          Name or any unique identifier of a path:
                    [pathname], [sessname:port], etc.

Options:
    verbose         Verbose output
    help            Display help and exit


.SH EXAMPLES
List devices

.B ibnbd list

List sessions

.B ibnbd list sess

List paths, display sizes in KB, display all columns


.B ibnbd list paths KB all

List only imported devices, show only mapping_path and devpath, output in json

.B ibnbd list devs clt mapping_path,devpath json

.SH COPYRIGHT
Copyright \(co 2019 IONOS Cloud GmbH. All Rights Reserved
.SH AUTHOR
Danil Kipnis <danil.kipnis@cloud.ionos.com>
